<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>日记账</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <link rel="stylesheet" href="../layui/css/layui.css"  media="all">
  <script src="../layui/layui.js" charset="utf-8"></script>
  
</head>
<body>

<center>
	<br>
  <div class="biaoti">
  		<h1>日记账</h1>
  </div>  
  <br>          
</center> 

<form class="layui-form" action="">
<div class="demoTable">
<div style="display: flex;">
  <div class="layui-form-item">
    <label class="layui-form-label">公司名称</label>
    <div class="layui-input-inline">
      <input id="company" type="text" name="company" lay-verify="required" placeholder="请输入客户名称" autocomplete="off" class="layui-input">
    </div>
  </div>
   <div class="layui-inline">
      <label class="layui-form-label">时间段</label>
      <div class="layui-input-inline">
        <input type="text" name="starttime" id="starttime" lay-verify="date" placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input">
      </div>
      
      <div class="layui-input-inline">
        <input type="text" name="endtime" id="endtime" lay-verify="date" placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input">
      </div>
    </div>
 <div class="layui-inline">
      <label class="layui-form-label">收支类型</label>
      <div class="layui-input-inline">
        <select name="types" lay-verify="required" lay-search=""  id="types">
          <option value="">直接选择或搜索选择</option>
          <option value="收入">收入</option>
          <option value="支出">支出</option>
        </select>
      </div>
    </div>
   				 <div class="layui-inline">
					<a class="layui-btn" data-type="reload">搜索</a>
				</div>
				&nbsp;&nbsp;&nbsp;
				
			<div class="layui-inline">
				<div class="layui-input-inline">
					<input type="text" name="heji" placeholder="合计" style="width: 90px" autocomplete="off"
						class="layui-input" id="aaa" readonly="true" size="35">
				</div>
				<a id="btn_rev" class="layui-btn">合计</a>
			</div>

 	 
</div>
</form> 




 

 
<script type="text/html" id="toolbarDemo">
  <div class="layui-btn-container">
    <button class="layui-btn layui-btn-sm" lay-event="getCheckData">获取选中行数据</button>
    <button class="layui-btn layui-btn-sm" lay-event="getCheckLength">获取选中数目</button>
    <button class="layui-btn layui-btn-sm" lay-event="isAll">验证是否全选</button>
  </div>
</script>
<script type="text/html" id="barDemo">
  <a id="edit" class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
  <a id="details" class="layui-btn layui-btn-xs" lay-event="details">详情</a>
  <a id="del" class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>	
</script>
<!-- <div type="text/html" id="barDemo">
<input id="edit"  type="button" value="编辑" class="layui-btn layui-btn-xs" lay-event="edit">
</div> -->





 <table class="layui-hide" id="test" lay-filter="test"></table>
 <script>
layui.use(['table','jquery','laypage','layer','form','laydate','carousel','upload'], function(){
	  var table = layui.table,laypage = layui.laypage,$ = layui.$,layer = layui.layer;
	  var form = layui.form,carousel = layui.carousel,upload = layui.upload;
	  var ins = carousel.render({}); 
	  var laypage = layui.laypage;

	  
//方法级渲染
  table.render({
    elem: '#test'
    ,url:'limit'
    ,response: {
    		    statusName: 'state' //规定数据状态的字段名称，默认：code
    		    ,statusCode: 2000 //规定成功的状态码，默认：0
    		     //,msgName: 'hint' //规定状态信息的字段名称，默认：msg
    		    //,countName: 'total' //规定数据总数的字段名称，默认：count
    		    //,dataName: 'rows' //规定数据列表的字段名称，默认：data 
    		  } 
    ,toolbar: '#toolbarDemo'
    ,title: '用户数据表'
    ,totalRow: true
    ,request:{pageName:'page',limitName:'limit'}
    
    ,limit: 10
    ,limits: [5,10,20,30,100]
    ,cols: [[
      {type: 'checkbox', fixed: 'left'}
      ,{field:'id', title:'编号', width:80, fixed: 'left', unresize: true, sort: true, totalRowText: '合计'}
      ,{field:'company', title:'对方单位', width:120, edit: 'text'}
      ,{field:'starttime', width:80, title: '时间', sort: true}
      ,{field:'types', width:80, title: '类型'}
      ,{field:'money', title: '金额',totalRow: true} //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
      ,{field:'zhifutype', title: '收款方式', sort: true}
      ,{field:'waiter', title: '服务人员', sort: true}
      ,{field:'beizhu', title: '备注', width: '30%', minWidth: 100}
      ,{field:'fujian', width:180, title: '附件',toolbar: '#barDemo', sort: true}
    ]]
    ,height: 420
    ,page: true
    ,id: 'testReload'
    ,done: function(res, curr, count){
        //如果是异步请求数据方式，res即为你接口返回的信息。
        //如果是直接赋值的方式，res即为：{data: [], count: 99} data为当前页数据、count为数据总长度
        console.log(res);
        
        //得到当前页码
        console.log(curr); 
        
        //得到数据总量
        console.log(count);
      }
    
  });
  
  
   //完整功能
  laypage.render({
    elem: 'testReload'
    ,limit:5
    ,count:30
    ,pages: 5
    ,groups: 0
    ,first: false
    ,last: false
    ,layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
    ,jump: function(obj){
      //alert(obj.count)
    }
  });  
  

//表格的重载.
  var $ = layui.$, active = {
		    reload: function(){
		    	 var demoReload = $('#company');
			      var demoReload1 = $('#types');
			 	  var date = $('#starttime');
			 	  var date1 = $('#endtime');

		      //执行重载
		      table.reload('testReload', {
		        page: {
		          curr: 1 //重新从第 1 页开始
		        }
		        ,where: {
		        	company: demoReload.val(),
		        	types:demoReload1.val(),
		        	starttime:date.val(),
		            endtime:date1.val()

					}
		      }, 'data');
		    }
		  };
		  
  $('.demoTable .layui-btn').on('click', function(){
	    var type = $(this).data('type');
	    active[type] ? active[type].call(this) : '';
	  });
  


//监听行工具事件
  table.on('tool(test)', function(obj){
    var data = obj.data;
    var id = data.id;
    
    if(obj.event === 'edit'){
    	$.ajax({
    		url:"http://localhost:8080/web/edit.html",
    		data:data,
    		dataType:"json",
    		success:function(){
    			
    		}
    	});
    			location.href="http://localhost:8080/web/edit.html?id="+id;
    } else if(obj.event === 'details'){
    	$.ajax({
    		url:"http://localhost:8080/web/details.html",
    		data:data,
    		dataType:"json",
    		success:function(){
    		}
    	});
    			location.href="http://localhost:8080/web/details.html?id="+id;
    }
    });


  

  
  //工具栏事件
  table.on('toolbar(test)', function(obj){
    var checkStatus = table.checkStatus(obj.config.id);
    switch(obj.event){
      case 'getCheckData':
        var data = checkStatus.data;
        layer.alert(JSON.stringify(data));
      break;
      case 'getCheckLength':
        var data = checkStatus.data;
        layer.msg('选中了：'+ data.length + ' 个');
      break;
      case 'isAll':
        layer.msg(checkStatus.isAll ? '全选': '未全选')
      break;
    };
  });
});
</script>



 <script>
 layui.use(['laypage', 'layer'], function(){
  var laypage = layui.laypage
  	 ,layer = layui.layer;
 
 /*   //完整功能
  laypage.render({
    elem: 'testReload'
    ,limit:10
    ,count:data.length
    ,layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
    ,jump: function(obj){
      console.log(obj)
      alert(obj)
    }
  });  */
  

 
  
  
});
</script>  

             
 



<script type="text/javascript">
	layui.use(['form','laydate','layer'], function(){
		  var form = layui.form
		  ,layer = layui.layer
		  ,layedit = layui.layedit
		  ,laydate = layui.laydate;
		  
		  //日期
		  laydate.render({
			elem : '#starttime'
			
			
		  });
		  laydate.render({
		    elem: '#endtime'
		    
		  });
		});
	 
	</script>


 <div style="float: right;
 		margin-right: 50px">
    <a href="addnew.html"><button type="button" class="layui-btn">添加记录</button></a>
  </div>
  <br>
  <br>



<script type="text/javascript" src="../web/jquery-3.4.1.min.js"></script>

<script type="text/javascript">
$("#edit").click(function() {
	

	layer.open({
	  type: 1,
	  skin: 'layui-layer-rim', //加上边框
	  area: ['420px', '240px'], //宽高
	  content: 'html内容'
	});


});
</script>



</body>
</html>